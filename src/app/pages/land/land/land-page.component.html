<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8 text-center mb-2">
            <h1 class="mt-4">Ayuda Valencia</h1>
            <p class="lead">Esta plataforma ha sido creada para facilitar la coordinación de ayuda durante emergencias. Aquí podrás informar sobre tus necesidades básicas durante una situación de emergencia.</p>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title mb-4">¿Qué necesitas?</h5>
                    
                    <div class="needs-container mb-4">
                        <div class="row">
                            <div class="col-12 col-md-6 mb-3" *ngFor="let need of needsList">
                                <mat-checkbox 
                                    [checked]="needs.includes(need.id)"
                                    (change)="toggleNeed(need.id)"
                                    color="primary"
                                    class="need-checkbox">
                                    {{need.label}}
                                </mat-checkbox>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mb-4">
                        <label for="otherNeeds">Otras necesidades</label>
                        <textarea class="form-control" 
                                id="otherNeeds" 
                                rows="3"
                                [(ngModel)]="otherNeeds"
                                placeholder="Describe cualquier otra necesidad que tengas...">
                        </textarea>
                    </div>

                    <div class="map-container mb-4" *ngIf="showMarker">
                        <div class="map-header d-flex justify-content-between align-items-center mb-2">
                            <p class="mb-0">Marca tu ubicación en el mapa</p>
                            <button class="btn btn-sm btn-outline-primary" (click)="getCurrentLocation()">
                                <i class="fa fa-location-arrow"></i> 
                                Obtener mi ubicación
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" (click)="centerValencia()">
                                <i class="fa fa-map-marker"></i> 
                                Centrar en Valencia
                            </button>
                        </div>
                        
                        <div class="map-wrapper">
                            <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom"  (mapReady)="mapReadyHandler($event)">
                                <agm-marker *ngIf="showMarker && lat!=0" [latitude]="lat" [longitude]="lng" [title]="'Pickup Location'"></agm-marker>
                            </agm-map>
                            <a *ngIf="showMarker && lat!=0" class="mt-2 btn btn-primary" (click)="deletelocation()">{{'war.nosharelocation' | translate }}</a>
                        </div>
                        
                        <small class="text-muted mt-2 d-block">
                            <i class="fa fa-info-circle"></i> 
                            Puedes ajustar la ubicación haciendo clic en el mapa o arrastrando el marcador
                        </small>
                    </div>

                    <div class="text-center">
                        <button class="btn btn-primary btn-lg" 
                                (click)="submitNeeds()">
                            Enviar solicitud
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>